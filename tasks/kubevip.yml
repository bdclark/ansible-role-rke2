---
- name: Copy kube-vip files to first server
  ansible.builtin.template:
    src: "{{ item }}"
    dest: "{{ rke2_data_path }}/server/manifests/{{ item | basename | regex_replace('.j2$', '') }}"
    owner: root
    group: root
    mode: 0664
  with_fileglob: "{{ rke2_ha_mode_kubevip_manifest_fileglob }}"

- name: Copy kube-vip load balancer manifests to first server
  ansible.builtin.template:
    src: "{{ item }}"
    dest: "{{ rke2_data_path }}/server/manifests/{{ item | basename | regex_replace('.j2$', '') }}"
    owner: root
    group: root
    mode: 0664
  with_fileglob: "{{ rke2_kubevip_cloud_provider_manifest_fileglob }}"
  when:
    - rke2_kubevip_cloud_provider_enable | bool
